\doxysection{VRE\+\_\+\+Game\+Object\+Manager.\+cpp}
\hypertarget{_v_r_e___game_object_manager_8cpp_source}{}\label{_v_r_e___game_object_manager_8cpp_source}\index{ReSTIRVulkan/VRE\_GameObjectManager.cpp@{ReSTIRVulkan/VRE\_GameObjectManager.cpp}}
\mbox{\hyperlink{_v_r_e___game_object_manager_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00001}00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00002}00002\ \textcolor{comment}{*\ \ Resources:}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00003}00003\ \textcolor{comment}{*\ \ \ Galea,\ B.\ (2020).\ Vulkan\ Game\ Engine\ Tutorial.\ [online]\ YouTube.}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00004}00004\ \textcolor{comment}{*\ \ \ \ \ \ \ Available\ at:\ https://www.youtube.com/watch?v=Y9U9IE0gVHA\&list=PL8327DO66nu9qYVKLDmdLW\_84-\/yE4auCR\&index=1\ and\ https://github.com/blurrypiano/littleVulkanEngine\ (Accessed\ 15\ June\ 2024).}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00005}00005\ \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00006}00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_v_r_e___game_object_manager_8h}{VRE\_GameObjectManager.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00008}00008\ \textcolor{preprocessor}{\#include\ <numeric>}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00010}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_af7164cc625602e237214f191767d803b}{00010}}\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_af7164cc625602e237214f191767d803b}{VRE::VRE\_GameObjectManager::VRE\_GameObjectManager}}(\mbox{\hyperlink{struct_v_r_e_1_1_v_r_e___shared_context}{VRE\_SharedContext}}*\ sharedContext)}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00011}00011\ \ \ \ \ :\ mSharedContext(sharedContext)\ \{\}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00014}00014\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00015}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a8354b09e8551cc468e3138ee62d420dc}{00015}}\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a8354b09e8551cc468e3138ee62d420dc}{VRE::VRE\_GameObjectManager::\string~VRE\_GameObjectManager}}()\ \{\}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00017}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a2e2611b8cc5c066b4f6109deb7ba15fa}{00017}}\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object}{VRE::VRE\_GameObject}}\&\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a2e2611b8cc5c066b4f6109deb7ba15fa}{VRE::VRE\_GameObjectManager::CreateGameObject}}()}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00018}00018\ \{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00019}00019\ \ \ \ \ assert(mLastID\ <\ \mbox{\hyperlink{namespace_v_r_e_aa9d1755788ca2e9061d788834a0ea1f2}{VRE::MAX\_OBJECT\_COUNT}}\ \&\&\ \textcolor{stringliteral}{"{}Max\ game\ object\ count\ exceeded!"{}});}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00020}00020\ \ \ \ \ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object}{VRE\_GameObject}}\ \textcolor{keywordtype}{object}\ =\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object}{VRE\_GameObject}}\{\ mLastID++,\ *\textcolor{keyword}{this}\ \};}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00021}00021\ \ \ \ \ \textcolor{keyword}{auto}\ \textcolor{keywordtype}{id}\ =\ \textcolor{keywordtype}{object}.\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_ad8fa8ae0bef9012e27aaed63f0fc7274}{GetID}}();}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00022}00022\ \ \ \ \ mGameObjectsMap.emplace(\textcolor{keywordtype}{id},\ std::move(\textcolor{keywordtype}{object}));}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00023}00023\ \ \ \ \ \textcolor{keywordflow}{return}\ mGameObjectsMap.at(\textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00024}00024\ \}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00026}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_ac6264ca87207da68f076fa336da86df9}{00026}}\ VkDescriptorBufferInfo\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_ac6264ca87207da68f076fa336da86df9}{VRE::VRE\_GameObjectManager::GetBufferInfoForGameObject}}(\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_a2800f0649021ba69a6052a5d436bbb50}{VRE\_GameObject::GameObjectID}}\ gObjectID)\textcolor{keyword}{\ const}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00027}00027\ \textcolor{keyword}{}\{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00028}00028\ \ \ \ \ \textcolor{keywordflow}{return}\ mUboBuffers[mSharedContext-\/>mRenderer-\/>GetFrameIndex()]-\/>DescriptorInfoForIndex(gObjectID);}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00029}00029\ \}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00031}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a6981546d7c23416f2e18ef19c470997c}{00031}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a6981546d7c23416f2e18ef19c470997c}{VRE::VRE\_GameObjectManager::Init}}()}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00032}00032\ \{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordtype}{int}\ alignment\ =\ std::lcm(mSharedContext-\/>mDevice-\/>mProperties.limits.nonCoherentAtomSize,}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00034}00034\ \ \ \ \ \ \ \ \ mSharedContext-\/>mDevice-\/>mProperties.limits.minUniformBufferOffsetAlignment);}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ mUboBuffers.size();\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00037}00037\ \ \ \ \ \ \ \ \ mUboBuffers[i]\ =\ std::make\_unique<VRE\_Buffer>(*mSharedContext-\/>mDevice,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_v_r_e_1_1_game_object_buffer_data}{GameObjectBufferData}}),\ \mbox{\hyperlink{namespace_v_r_e_aa9d1755788ca2e9061d788834a0ea1f2}{VRE::MAX\_OBJECT\_COUNT}},}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ VK\_BUFFER\_USAGE\_UNIFORM\_BUFFER\_BIT,\ VK\_MEMORY\_PROPERTY\_HOST\_VISIBLE\_BIT,\ alignment);}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00039}00039\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00040}00040\ \ \ \ \ \ \ \ \ mUboBuffers[i]-\/>Map();}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00041}00041\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00042}00042\ \}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00044}\mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a3fca39debcadbe4d7bdb87acfa6b0496}{00044}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_r_e_1_1_v_r_e___game_object_manager_a3fca39debcadbe4d7bdb87acfa6b0496}{VRE::VRE\_GameObjectManager::Update}}(\textcolor{keywordtype}{float}\ deltaTime)}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00045}00045\ \{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ e\ :\ mGameObjectsMap)\ \{}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\&\ obj\ =\ e.second;}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00048}00048\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_v_r_e_1_1_game_object_buffer_data}{GameObjectBufferData}}\ data\{\};}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00049}00049\ \ \ \ \ \ \ \ \ data.\mbox{\hyperlink{struct_v_r_e_1_1_game_object_buffer_data_a2c96b27ec5bcae522cbe360d69979d26}{mModelMatrix}}\ =\ obj.mTransform.Mat4();}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00050}00050\ \ \ \ \ \ \ \ \ data.mNormalMatrix\ =\ obj.mTransform.NormalMatrix();}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00051}00051\ \ \ \ \ \ \ \ \ mUboBuffers[mSharedContext-\/>mRenderer-\/>GetFrameIndex()]-\/>WriteToIndex(\&data,\ e.first);}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00052}00052\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00053}00053\ \ \ \ \ mUboBuffers[mSharedContext-\/>mRenderer-\/>GetFrameIndex()]-\/>Flush();}
\DoxyCodeLine{\Hypertarget{_v_r_e___game_object_manager_8cpp_source_l00054}00054\ \}}

\end{DoxyCode}
